<!doctype html>
<html lang="sv" data-theme="light">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bredbands- & TV-kompassen Pro 3.7</title>
<style>
:root{
  --bg:#f6f7fb;--card:#ffffff;--line:#e0e4ef;--text:#111318;--muted:#5f6675;--accent:#3b6aff;
  --gold:#d8b55f;--gold-ink:#1b1400;--shadow:0 6px 24px rgba(10,20,40,.08)
}
html[data-theme=dark]{
  --bg:#0f1115;--card:#141820;--line:#242b3a;--text:#e9edf5;--muted:#9aa3b2;--accent:#7aa2ff;
  --gold:#caa24e;--gold-ink:#0d0b00;--shadow:0 8px 28px rgba(0,0,0,.35)
}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
header{
  position:sticky;top:0;z-index:10;backdrop-filter:blur(6px);
  background:color-mix(in oklab, var(--bg) 90%, transparent);
  border-bottom:1px solid var(--line);padding:12px 16px;display:flex;gap:12px;align-items:center;justify-content:space-between
}
h1{margin:0;font-size:18px;font-weight:800}
.right{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.btn{border:1px solid var(--line);background:var(--card);color:inherit;border-radius:12px;padding:8px 12px;cursor:pointer;font-weight:700;box-shadow:var(--shadow)}
.btn.ghost{background:transparent}
.searchbar{display:flex;align-items:center;gap:8px;background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px 12px;box-shadow:var(--shadow)}
.searchbar input{all:unset;width:220px}
main{max-width:1300px;margin:18px auto;padding:0 16px;display:flex;flex-direction:column;gap:18px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:14px;box-shadow:var(--shadow)}
.summary-top{text-align:center;padding:24px 14px}
.summary-top h2{margin:0 0 6px 0}
.summary-grid{display:flex;flex-wrap:wrap;justify-content:center;gap:18px}
.summary-grid .box{min-width:160px}
.summary-grid .val{font-size:24px;font-weight:900}
.layout{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(320px,1fr))}
details.widget{border:1px solid var(--line);border-radius:14px;overflow:hidden}
details.widget>summary{list-style:none;padding:10px 12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;font-weight:800}
details.widget>summary::-webkit-details-marker{display:none}
.widget-body{border-top:1px dashed var(--line);padding:10px}
.plan{display:grid;grid-template-columns:1fr 120px 120px;align-items:center;gap:10px;
  border:1px solid var(--line);border-radius:12px;padding:8px 10px;margin:8px 0}
.plan.selected{border-color:var(--gold);box-shadow:0 0 0 2px color-mix(in oklab, var(--gold) 30%, transparent)}
.plan label{display:flex;align-items:center;gap:10px;cursor:pointer;font-weight:700}
.input-wrap{display:flex;flex-direction:column;gap:4px}
.input-wrap input[type=number]{width:100%;background:var(--card);border:1px solid var(--line);
  border-radius:8px;padding:6px 8px;text-align:right;font-weight:600}
.input-wrap input.active{background:var(--gold);color:var(--gold-ink)}
.svc{border:1px solid var(--line);border-radius:12px;padding:8px 10px;margin:8px 0}
.svc header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.svc .row{display:flex;justify-content:space-between;align-items:center;border:1px dashed var(--line);
  border-radius:10px;padding:8px;margin:6px 0}
.svc label{display:flex;align-items:center;gap:8px;cursor:pointer}
.price{font-weight:800}
</style>
</head>
<body>
<header>
  <h1>Bredbands- & TV-kompassen</h1>
  <div class="right">
    <div class="searchbar">
      üîé <input id="search" placeholder="S√∂k paket eller tj√§nst...">
      <button id="clearSearch" class="btn ghost">Rensa</button>
    </div>
    <button id="themeBtn" class="btn">M√∂rkt l√§ge</button>
    <button id="resetBtn" class="btn ghost">√Öterst√§ll</button>
  </div>
</header>

<main>
  <section id="calcSummary" class="card summary-top">
    <h2>Samlad kalkyl</h2>
    <div class="summary-grid">
      <div class="box"><div>F√∂rsta 6 m√•n</div><div id="s1" class="val">0 SEK</div></div>
      <div class="box"><div>Andra 6 m√•n</div><div id="s2" class="val">0 SEK</div></div>
      <div class="box"><div>Hel√•r totalt</div><div id="year" class="val">0 SEK</div></div>
      <div class="box"><div>Snitt / m√•n</div><div id="avg" class="val">0 SEK</div></div>
    </div>
  </section>

  <section class="layout" id="widgets"></section>
</main>

<script>
const GROUPS=[
  {cat:"Bredband",plans:[
    {id:"bb100",label:"100/100 Mbit/s"},
    {id:"bb300",label:"300/300 Mbit/s"},
    {id:"bb1000",label:"1000/1000 Mbit/s"}]},
  {cat:"TV grundpaket",plans:[
    {id:"mini",label:"TV Mini"},
    {id:"mellan",label:"TV Mellan"},
    {id:"mycket",label:"TV Mycket"}]},
  {cat:"Premium TV / Streaming",plans:[
    {id:"mer",label:"Streaming Mer"},
    {id:"maxad",label:"Streaming Maxad"},
    {id:"mest",label:"Streaming Mest"}]}
];
const STREAMS=[
{id:'netflix',name:'Netflix',plans:[
  {id:'basic',label:'Basic',priceSEK:109},
  {id:'standard',label:'Standard',priceSEK:149},
  {id:'premium',label:'Premium (4K)',priceSEK:199}]},
{id:'disney',name:'Disney+',plans:[
  {id:'ads',label:'Standard m. reklam',priceSEK:59},
  {id:'standard',label:'Standard utan reklam',priceSEK:99},
  {id:'premium',label:'Premium (4K utan reklam)',priceSEK:139}]},
{id:'max',name:'Max (HBO/Discovery)',plans:[
  {id:'basicAds',label:'Basic med reklam',priceSEK:89},
  {id:'standard',label:'Standard utan reklam (FHD)',priceSEK:129},
  {id:'premium',label:'Premium (4K utan reklam)',priceSEK:169},
  {id:'sportBase',label:'Sport Bas',priceSEK:260},
  {id:'sportPremium',label:'Sport Premium',priceSEK:360},
  {id:'sportTotal',label:'Sport Total',priceSEK:460}]},
{id:'prime',name:'Amazon Prime Video',plans:[
  {id:'ads',label:'Med reklam',priceSEK:59},
  {id:'adfree',label:'Utan reklam',priceSEK:88}]},
{id:'tv4',name:'TV4 Play',plans:[
  {id:'free',label:'Gratis (med reklam)',priceSEK:0},
  {id:'plus',label:'Plus (med reklam)',priceSEK:69},
  {id:'plusNoAds',label:'Plus utan reklam',priceSEK:169},
  {id:'sportAds',label:'Sport med reklam',priceSEK:349},
  {id:'sport',label:'Sport utan reklam',priceSEK:399},
  {id:'sportTotal',label:'Sport Total',priceSEK:599}]},
{id:'viaplay',name:'Viaplay',plans:[
  {id:'films',label:'Film & Serier',priceSEK:169},
  {id:'medium',label:'Medium (sport)',priceSEK:399},
  {id:'totalAds',label:'Total m. reklam',priceSEK:649},
  {id:'total',label:'Total utan reklam',priceSEK:699}]}
];
let state={sel:{},custom:{},streams:{}}; const fmt=v=>`${(v||0).toFixed(0)} SEK`;
function $(s,r=document){return r.querySelector(s);} function $$(s,r=document){return[...r.querySelectorAll(s)];}
function build(){const w=$('#widgets');w.innerHTML='';
  GROUPS.forEach(g=>{
    const det=document.createElement('details');det.className='widget';det.open=true;
    det.innerHTML=`<summary>${g.cat}</summary><div class="widget-body">${
      g.plans.map(p=>`<div class="plan" data-cat="${g.cat}" data-id="${p.id}">
        <label><input type="radio" name="${g.cat}" value="${p.id}">${p.label}</label>
        <div class="input-wrap"><input type="number" class="m6a" placeholder="0"><small>6 m√•n (1)</small></div>
        <div class="input-wrap"><input type="number" class="m6b" placeholder="0"><small>6 m√•n (2)</small></div>
      </div>`).join('')}</div>`;w.appendChild(det);
  });
  const det=document.createElement('details');det.className='widget';det.open=true;
  det.innerHTML=`<summary>Streamingkostnader ‚Äì Sverige</summary>`;
  const b=document.createElement('div');b.className='widget-body';
  STREAMS.forEach(s=>{
    const c=document.createElement('div');c.className='svc';c.innerHTML=
      `<header><strong>${s.name}</strong></header>${
        s.plans.map(p=>`<div class="row">
           <label><input type="radio" name="${s.id}" value="${p.id}">${p.label}</label>
           <div class="price">${fmt(p.priceSEK)}</div></div>`).join('')}`;
    b.appendChild(c);
  });det.appendChild(b);w.appendChild(det);
  attachEvents();
}
function attachEvents(){
  $$('input[type=radio]').forEach(r=>r.onchange=()=>{const cat=r.name;
    if(STREAMS.find(s=>s.id===cat))state.streams[cat]=r.value;
    else state.sel[cat]=r.value;
    update();
  });
  $$('.m6a,.m6b').forEach(i=>{
    i.oninput=()=>{const row=i.closest('.plan');const id=row.dataset.id;
      const a=parseFloat($('.m6a',row).value)||0;const b=parseFloat($('.m6b',row).value)||0;
      state.custom[id]={m6a:a,m6b:b};update();i.classList.toggle('active',i.value!=='');
    };
  });
}
function sumStream(){let s=0;STREAMS.forEach(sv=>{const pid=state.streams[sv.id];
  const p=sv.plans.find(x=>x.id===pid);if(p)s+=p.priceSEK;});return s;}
function update(){
  let s1=0,s2=0;
  GROUPS.forEach(g=>{const pid=state.sel[g.cat];if(!pid)return;
    const r=$(`.plan[data-id="${pid}"]`);
    const a=parseFloat($('.m6a',r).value)||0;const b=parseFloat($('.m6b',r).value)||0;
    s1+=a*6;s2+=b*6;
  });
  const st=sumStream()*6; s1+=st; s2+=st;
  const year=s1+s2;const avg=year/12;
  $('#s1').textContent=fmt(s1);$('#s2').textContent=fmt(s2);
  $('#year').textContent=fmt(year);$('#avg').textContent=fmt(avg);
}
$('#search').oninput=e=>{
  const q=e.target.value.toLowerCase();
  $$('.plan,.svc').forEach(el=>{
    el.style.display=!q||el.textContent.toLowerCase().includes(q)?'':'none';
  });
};
$('#clearSearch').onclick=()=>{$('#search').value='';$('#search').dispatchEvent(new Event('input'));};
$('#themeBtn').onclick=()=>{
  const d=document.documentElement.getAttribute('data-theme')==='dark';
  document.documentElement.setAttribute('data-theme',d?'light':'dark');
  $('#themeBtn').textContent=d?'M√∂rkt l√§ge':'Ljust l√§ge';
};
$('#resetBtn').onclick=()=>{state={sel:{},custom:{},streams:{}};build();update();};
build();update();
</script>
</body>
</html>
