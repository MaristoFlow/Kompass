<!doctype html>
<html lang="sv" data-theme="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bredbands- & TV-kompassen 3.0 – Churnläge</title>
<style>
:root{
 --bg:#0f1115;--card:#141820;--line:#242b3a;--text:#e9edf5;--muted:#9aa3b2;--accent:#7aa2ff;
}
html[data-theme=light]{--bg:#f6f7fb;--card:#fff;--line:#e0e4ef;--text:#10131a;--muted:#5b6575;--accent:#3b6aff}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
header{padding:16px;border-bottom:1px solid var(--line);display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between}
h1{margin:0;font-size:18px}
.btn{border:1px solid var(--line);background:transparent;color:inherit;border-radius:10px;padding:6px 10px;cursor:pointer;font-weight:600}
.btn.primary{background:var(--accent);color:#fff;border:none}
main{max-width:1200px;margin:0 auto;padding:16px;display:grid;grid-template-columns:1fr 360px;gap:16px}
@media(max-width:900px){main{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px}
details.widget{border:1px solid var(--line);border-radius:10px;margin-bottom:10px}
details>summary{list-style:none;padding:8px 10px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:700}
details>summary::-webkit-details-marker{display:none}
.plan{display:grid;grid-template-columns:1fr 70px 70px 70px 80px;align-items:center;gap:6px;border:1px solid var(--line);border-radius:10px;padding:6px 8px;margin:6px 0}
.plan:hover{background:rgba(122,162,255,.06)}
.plan input[type=number]{width:100%;background:var(--card);border:1px solid var(--line);color:var(--text);border-radius:6px;padding:3px 4px;text-align:right}
.plan .disc{font-size:12px;color:var(--muted);text-align:right}
.selected{border-color:var(--accent);box-shadow:0 0 0 2px rgba(122,162,255,.25)}
.total-card .row{display:flex;justify-content:space-between;margin:6px 0}
.total-card .grand{font-size:20px;font-weight:700}
hr{border:0;border-top:1px dashed var(--line);margin:8px 0}
</style>
</head>
<body>
<header>
 <h1>Bredbands- & TV-kompassen</h1>
 <div class="right">
   <button id="themeBtn" class="btn">Tema</button>
   <button id="resetBtn" class="btn">Återställ</button>
 </div>
</header>

<main>
 <section id="services" class="card"></section>

 <aside class="card total-card">
   <h2>Summering</h2><hr>
   <div class="row"><div>Ordinarie pris/mån</div><div id="ordTot">0 SEK</div></div>
   <div class="row"><div>Snitt kundpris/mån</div><div id="kundTot" class="grand">0 SEK</div></div>
   <div class="row"><div>Årligt pris</div><div id="yearTot">0 SEK</div></div>
   <div class="row"><div>Total rabatt</div><div id="rabTot">0 SEK (0 %)</div></div>
 </aside>
</main>

<script>
const DATA=[
 {cat:"Bredband",plans:[
  {id:"bb100",label:"100/100 Mbit/s",price:599},
  {id:"bb300",label:"300/300 Mbit/s",price:389},
  {id:"bb1000",label:"1000/1000 Mbit/s",price:599}
 ]},
 {cat:"TV grundpaket",plans:[
  {id:"mini",label:"TV Mini",price:149},
  {id:"mellan",label:"TV Mellan",price:249},
  {id:"mycket",label:"TV Mycket",price:499}
 ]},
 {cat:"Premium TV / Streaming",plans:[
  {id:"mer",label:"Streaming Mer",price:199},
  {id:"maxad",label:"Streaming Maxad",price:299},
  {id:"mest",label:"Streaming Mest",price:499}
 ]},
 {cat:"Enskilda Streaming-tjänster",plans:[
  {id:"netflix",label:"Netflix Standard",price:149},
  {id:"disney",label:"Disney+ Standard",price:99},
  {id:"max",label:"Max (HBO/Discovery)",price:129},
  {id:"prime",label:"Amazon Prime Video",price:59},
  {id:"tv4",label:"TV4 Play Plus utan reklam",price:169},
  {id:"viaplay",label:"Viaplay Film & Serier",price:169}
 ]}
];
const fmt=v=>`${v.toFixed(0)} SEK`;

function build(){
 const wrap=document.getElementById('services');wrap.innerHTML='';
 DATA.forEach(s=>{
  const det=document.createElement('details');det.className='widget';det.open=true;
  det.innerHTML=`<summary>${s.cat}</summary>
  <div class="widget-body">
  ${s.plans.map(p=>`
   <div class="plan" data-price="${p.price}">
    <label><input type="radio" name="${s.cat}" value="${p.id}"> ${p.label}</label>
    <div>${fmt(p.price)}</div>
    <input type="number" class="m6a" value="${p.price}" min="0" step="1">
    <input type="number" class="m6b" value="${p.price}" min="0" step="1">
    <div class="disc">0 %</div>
   </div>`).join('')}
  </div>`;
  wrap.appendChild(det);
 });
 document.querySelectorAll('.plan input[type=radio]').forEach(r=>r.addEventListener('change',calc));
 document.querySelectorAll('.m6a,.m6b').forEach(i=>i.addEventListener('input',calc));
}

function calc(){
 let ord=0,kund=0;
 document.querySelectorAll('.plan.selected').forEach(p=>p.classList.remove('selected'));
 document.querySelectorAll('input[type=radio]:checked').forEach(r=>{
  const row=r.closest('.plan');row.classList.add('selected');
  const p=+row.dataset.price;
  const k1=+row.querySelector('.m6a').value||0;
  const k2=+row.querySelector('.m6b').value||0;
  const snitt=(k1+k2)/2;
  ord+=p;kund+=snitt;
  const diff=p-snitt;const perc=diff/p*100;
  row.querySelector('.disc').textContent=`-${diff.toFixed(0)} SEK (${perc.toFixed(0)} %)`;
 });
 const rab=ord-kund;
 document.getElementById('ordTot').textContent=fmt(ord);
 document.getElementById('kundTot').textContent=fmt(kund);
 document.getElementById('yearTot').textContent=fmt(kund*12);
 document.getElementById('rabTot').textContent=`-${fmt(rab)} (${((rab/ord)*100||0).toFixed(0)} %)`;
}

document.getElementById('resetBtn').onclick=()=>{document.querySelectorAll('input').forEach(i=>{if(i.type==='radio')i.checked=false;else i.value=i.defaultValue});calc();};
document.getElementById('themeBtn').onclick=()=>{const h=document.documentElement;h.dataset.theme=h.dataset.theme==='light'?'dark':'light';};
build();calc();
</script>
</body>
</html>
